{"timestamp": "2025-12-21T23:17:03.922051", "question": "Countries with over 1 billion in trade?", "sql": "SELECT Country, SUM(Value) as TotalTrade\nFROM trade\nWHERE Year IN (2077, 2078, 2079, 2080, 2081, 2082) -- replace with actual years\nGROUP BY Country\nHAVING SUM(Value) > 1000000000 -- replace with billion\nORDER BY TotalTrade DESC\nLIMIT 5;", "error": "Regenerated SQL invalid: Only SELECT queries are allowed"}
{"timestamp": "2025-12-21T23:17:32.820850", "question": "Median trade value approximation?", "sql": "SELECT AVG(Value) as median_trade_value FROM trade WHERE Year BETWEEN 2077 AND 2082 AND Direction IN ('I', 'E') GROUP BY Year HAVING Year = (SELECT YEAR(random() * (2082 - 2077) + 2077) FROM trade);", "error": "Query execution failed: Binder Error: No function matches the given name and argument types 'year(DOUBLE)'. You might need to add explicit type casts.\n\tCandidate functions:\n\tyear(DATE) -> BIGINT\n\tyear(TIMESTAMP) -> BIGINT\n\tyear(INTERVAL) -> BIGINT\n\tyear(TIMESTAMP WITH TIME ZONE) -> BIGINT\n\nLINE 1: ...') GROUP BY Year HAVING Year = (SELECT YEAR(random() * (2082 - 2077) + 2077) F...\n                                                  ^"}
{"timestamp": "2025-12-21T23:19:51.438682", "question": "Countries with over 1 billion in trade?", "sql": "SELECT Country, SUM(Value) as TotalTrade\nFROM trade\nWHERE Year IN (2077, 2078, 2079, 2080, 2081, 2082) -- replace with actual years\nGROUP BY Country\nHAVING SUM(Value) > 1000000000 -- replace with billion\nORDER BY TotalTrade DESC\nLIMIT 5;", "error": "Regenerated SQL invalid: Only SELECT queries are allowed"}
{"timestamp": "2025-12-21T23:20:07.655245", "question": "Distinct country-year combinations?", "sql": "SELECT Country, Year \nFROM trade \nWHERE Direction IN ('I', 'E') \nGROUP BY Country, Year\nORDER BY random()\nLIMIT N;", "error": "Query execution failed: Binder Error: Referenced column \"N\" not found in FROM clause!\nLINE 6: LIMIT N;\n              ^"}
{"timestamp": "2025-12-21T23:28:01.394234", "question": "Show me the trade balance (exports - imports) by country", "sql": "SELECT Country, SUM(CASE WHEN Direction='E' THEN Value ELSE 0 END) as Exports, \n       SUM(CASE WHEN Direction='I' THEN Value ELSE 0 END) as Imports,\n       SUM(Value) OVER() as TotalTrade, \n       (SUM(Value) OVER() - SUM(CASE WHEN Direction='I' THEN Value ELSE 0 END)) as Balance\nFROM trade\nWHERE Year = 2022 AND Direction IN ('I', 'E')\nGROUP BY Country\nORDER BY TotalTrade DESC;", "error": "Regeneration failed: Query execution failed: Binder Error: column \"Value\" must appear in the GROUP BY clause or must be part of an aggregate function.\nEither add it to the GROUP BY list, or use \"ANY_VALUE(Value)\" if the exact value of \"Value\" is not important.\nLINE 3:        SUM(Value) OVER() as TotalTrade, \n                   ^"}
{"timestamp": "2025-12-21T23:28:17.782458", "question": "Which countries have trade deficits with Nepal?", "sql": "SELECT c.Country, SUM(t.Value) as Deficit\nFROM trade t\nJOIN country c ON t.Country = c.ISO_Code\nWHERE Direction = 'I' AND (c.ISO_Code NOT IN ('NP') OR t.Country IS NULL) -- Nepal is not a trading partner or data missing for that country\nGROUP BY c.Country\nHAVING SUM(t.Value) > 0\nORDER BY Deficit DESC;", "error": "Query execution failed: Catalog Error: Table with name country does not exist!\nDid you mean \"pg_constraint\"?\nLINE 3: JOIN country c ON t.Country = c.ISO_Code\n             ^"}
{"timestamp": "2025-12-21T23:28:56.455357", "question": "Countries that export to us but we don't export to them?", "sql": "SELECT DISTINCT c1.Country \nFROM trade t1 \nJOIN trade t2 ON t1.HS_Code = t2.HS_Code \nWHERE t1.Direction = 'E' AND t2.Direction = 'I' \nAND t1.Country NOT IN (SELECT Country FROM trade WHERE Direction = 'E' AND HS_Code = t1.HS_Code)\nORDER BY RAND() LIMIT 5;", "error": "Query execution failed: Binder Error: Referenced table \"c1\" not found!\nCandidate tables: \"t1\"\nLINE 1: SELECT DISTINCT c1.Country \n                        ^"}
{"timestamp": "2025-12-21T23:32:42.486791", "question": "HS codes starting with 84 in imports?", "sql": "SELECT HS_Code, SUM(Value) FROM trade WHERE Direction = 'I' AND LEFT(HS_Code, 2) = '84';", "error": "Query execution failed: Binder Error: No function matches the given name and argument types 'left(BIGINT, INTEGER_LITERAL)'. You might need to add explicit type casts.\n\tCandidate functions:\n\tleft(VARCHAR, BIGINT) -> VARCHAR\n\nLINE 1: ...) FROM trade WHERE Direction = 'I' AND LEFT(HS_Code, 2) = '84';\n                                                  ^"}
{"timestamp": "2025-12-21T23:35:37.924104", "question": "Which year had more than 100000 trade records?", "sql": "SELECT Year FROM trade WHERE COUNT(*) > 100000 GROUP BY Year ORDER BY Year;", "error": "Query execution failed: Binder Error: WHERE clause cannot contain aggregates!\nLINE 1: SELECT Year FROM trade WHERE COUNT(*) > 100000 GROUP BY Year ORDER B...\n                                     ^"}
{"timestamp": "2025-12-21T23:37:31.516549", "question": "Years where average monthly trade exceeded 500 million", "sql": "SELECT Year \nFROM (\n  SELECT Year, AVG(SUM(Value)) OVER(ORDER BY Month) as avg_monthly_trade\n  FROM trade\n  WHERE Direction IN ('I', 'E')\n  GROUP BY Year\n) AS yearly_avg\nWHERE avg_monthly_trade > 500000000;", "error": "Regeneration failed: Query execution failed: Binder Error: column \"Month\" must appear in the GROUP BY clause or must be part of an aggregate function.\nEither add it to the GROUP BY list, or use \"ANY_VALUE(Month)\" if the exact value of \"Month\" is not important.\nLINE 3: ... Year \nFROM (\n  SELECT Year, AVG(SUM(Value)) OVER(ORDER BY Month) as avg_monthly_trade\n                                                  ^"}
